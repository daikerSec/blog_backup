<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>利用Nebula学习Linux提权 | daiker&#39;s blog</title>
    
    
        <meta name="keywords" content="Linux,提权,渗透测试" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="0x00 Nebula介绍和玩法Nebula 是# Exploit Exercises 上的基础关他涉及了基本的源码级漏洞分析、提权。可以通过官网下载镜像进行安装。每一关都对应系统中以level开头的账号，密码与账号名相同（比如Level01,对应的系统帐号是level01），每玩一关，都需要用对应的账号登录系统，然后进入到/home/flag×目录中，与该level相关的代码、数据等都放在于此。">
<meta name="keywords" content="Linux,提权,渗透测试">
<meta property="og:type" content="article">
<meta property="og:title" content="利用Nebula学习Linux提权">
<meta property="og:url" content="http://www.daikersec.com/wiki/5c949747.html">
<meta property="og:site_name" content="daiker&#39;s blog">
<meta property="og:description" content="0x00 Nebula介绍和玩法Nebula 是# Exploit Exercises 上的基础关他涉及了基本的源码级漏洞分析、提权。可以通过官网下载镜像进行安装。每一关都对应系统中以level开头的账号，密码与账号名相同（比如Level01,对应的系统帐号是level01），每玩一关，都需要用对应的账号登录系统，然后进入到/home/flag×目录中，与该level相关的代码、数据等都放在于此。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-968153e5e4a3fb30.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-38e7dea4087e2f0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-ddf0bd66d9fab286.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-51d87655eb032c8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-bb403037400503a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-75e27c0b066bfa50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-8ce2a50e7a50a783.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-a88076a133a16e24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-09048910817293bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-326b1e34111dcb4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-74c7cc753e68f46b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-382ad96faf251a97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-7ee53af01e3ece0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-d30318a0f9bd3f7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-356a30698bc1a87e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-8fec3b78daf9ddca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-a53be6bb86afe6bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-17ad621643eb194c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-4c5f2065afbccb0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-801ef1892f28383a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-a1d5b80a3510410a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-484f9d9e3d8606ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-b2096557d4e9ec72.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-fd871199d9ea41db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-7aedc30548473071.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-0f2d1200236ef762.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-1a8cd7ab4c2f8ea4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-09cf1de358ac6548.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-a4762cc935be3785.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-c4689c881e588181.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-bb28c87f585db5a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-9763e2be88a4e633.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-76e63267a2c50648.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-4f09ec4a8d99b13e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-a48742e20d61da5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-298de17773e2bd71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-594ecec88edc3427.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-f39225877ed23dc8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5443560-5b493df2ecca5a4b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-06-20T05:58:38.725Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="利用Nebula学习Linux提权">
<meta name="twitter:description" content="0x00 Nebula介绍和玩法Nebula 是# Exploit Exercises 上的基础关他涉及了基本的源码级漏洞分析、提权。可以通过官网下载镜像进行安装。每一关都对应系统中以level开头的账号，密码与账号名相同（比如Level01,对应的系统帐号是level01），每玩一关，都需要用对应的账号登录系统，然后进入到/home/flag×目录中，与该level相关的代码、数据等都放在于此。">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/5443560-968153e5e4a3fb30.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    

    
        <link rel="alternate" href="/atom.xml" title="daiker&#39;s blog" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">
    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


    
        <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">daiker&#39;s blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="https://www.gravatar.com/avatar/17958dc3fe981da8c50766fef3c5872b" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="https://www.gravatar.com/avatar/17958dc3fe981da8c50766fef3c5872b?s=128" />
            <h2 id="name">daiker</h2>
            <h3 id="title">daiker&#39;s wiki</h3>
            <span id="location"><i class="fa fa-map-marker"></i>XiaMen, China</span>
            <a id="follow" target="_blank" href="https://github.com/daikersec/">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                14
                <span>文章</span>
            </div>
            <div class="article-info-block">
                21
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/daikersec/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/atom.xml" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>分类</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-up fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Linux
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            内核
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/b309a0f3.html">Linuxv0.11源码分析之引导启动程序一</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            取证
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            流量分析
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/ba9a968.html">铁人三项2018第七赛区(福建)数据赛wp</a></li>  <li class="file"><a href="/wiki/3c7f43ba.html">铁人三项数据赛样题分析</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            渗透测试
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Web安全
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            SQL注入
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/a62e54a0.html">CTF中SQL注入字段名被过滤小技巧</a></li>  <li class="file"><a href="/wiki/7e490dd2.html">insert 注入</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            反序列化漏洞
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/39a24cc2.html">php反序列化漏洞</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            命令执行
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/8f0228b2.html">happyMoctf-ping一下好吗WP</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            工具使用
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/9668f403.html">metasploit在后渗透中的作用</a></li>  <li class="file"><a href="/wiki/376537a6.html">解决msf内存不足不能启动的问题</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            提权
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Linux
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file active"><a href="/wiki/5c949747.html">利用Nebula学习Linux提权</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            渗透思路
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/c445d4db.html">一次简单渗透</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            漏洞挖掘
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            二进制漏洞
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/11af4bf6.html">PWN环境搭建</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            代码审计
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            php
                        </a>
                         <ul class="unstyled" id="tree" style="display: block;">  <li class="file"><a href="/wiki/4249e474.html">CTF中代码审计小trick(未完)</a></li>  <li class="file"><a href="/wiki/1067b4de.html">PHP危险函数总结(随时补充)</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                     </ul> 
                    </li> 
                     </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title"><span>标签云</span></h3>
        <div class="widget tagcloud">
            <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/Kali/" style="font-size: 13.33px;">Kali</a> <a href="/tags/Linux/" style="font-size: 16.67px;">Linux</a> <a href="/tags/Web/" style="font-size: 20px;">Web</a> <a href="/tags/ctf/" style="font-size: 16.67px;">ctf</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/pwn/" style="font-size: 10px;">pwn</a> <a href="/tags/tools/" style="font-size: 13.33px;">tools</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/wireshark/" style="font-size: 13.33px;">wireshark</a> <a href="/tags/代码审计/" style="font-size: 10px;">代码审计</a> <a href="/tags/内核/" style="font-size: 10px;">内核</a> <a href="/tags/取证/" style="font-size: 13.33px;">取证</a> <a href="/tags/提权/" style="font-size: 13.33px;">提权</a> <a href="/tags/数据分析/" style="font-size: 13.33px;">数据分析</a> <a href="/tags/日志分析/" style="font-size: 13.33px;">日志分析</a> <a href="/tags/注入/" style="font-size: 13.33px;">注入</a> <a href="/tags/流量分析/" style="font-size: 13.33px;">流量分析</a> <a href="/tags/渗透/" style="font-size: 10px;">渗透</a> <a href="/tags/渗透测试/" style="font-size: 10px;">渗透测试</a> <a href="/tags/漏洞研究/" style="font-size: 13.33px;">漏洞研究</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title"><span>链接</span></h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://www.iFurySt.com">iFurySt</a>
                    </li>
                
                    <li>
                        <a href="http://wyAtu.github.io">wyAtu</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-利用Nebula学习Linux提权" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/渗透测试/">渗透测试</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/渗透测试/提权/">提权</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/渗透测试/提权/Linux/">Linux</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Linux/">Linux</a>, <a class="tag-link" href="/tags/提权/">提权</a>, <a class="tag-link" href="/tags/渗透测试/">渗透测试</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/5c949747.html">
            <time datetime="2018-06-04T09:00:24.000Z" itemprop="datePublished">2018-06-04</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a href='https://github.com/daikersec/daikersec.github.io/raw/hexo/source/_posts/利用Nebula学习Linux提权.md'> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/daikersec/daikersec.github.io/edit/hexo/source/_posts/利用Nebula学习Linux提权.md'> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a href='https://github.com/daikersec/daikersec.github.io/commits/hexo/source/_posts/利用Nebula学习Linux提权.md'> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            利用Nebula学习Linux提权
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <h2 id="0x00-Nebula介绍和玩法"><a href="#0x00-Nebula介绍和玩法" class="headerlink" title="0x00 Nebula介绍和玩法"></a>0x00 Nebula介绍和玩法</h2><p>Nebula 是# <a href="https://exploit-exercises.com/" target="_blank" rel="noopener">Exploit Exercises </a>上的基础关<br>他涉及了基本的<code>源码级漏洞分析</code>、<code>提权</code>。可以通过官网下载镜像进行安装。<br>每一关都对应系统中以level开头的账号，密码与账号名相同（比如<code>Level01</code>,对应的系统帐号是<code>level0</code>1），每玩一关，都需要用对应的账号登录系统，然后进入到<code>/home/flag×</code>目录中，与该level相关的代码、数据等都放在于此。之后通过运行getflag 来验证是否提权成功</p>
<h2 id="0x01-level00"><a href="#0x01-level00" class="headerlink" title="0x01 level00"></a>0x01 level00</h2><blockquote>
<p>This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.</p>
</blockquote>
<p>查找suid的程序，直接通过find查找<br><a id="more"></a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>
<p>看到比较奇怪的一个文件<code>/bin/.../flag00</code><br><img src="https://upload-images.jianshu.io/upload_images/5443560-968153e5e4a3fb30.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>提权成功<br><img src="https://upload-images.jianshu.io/upload_images/5443560-38e7dea4087e2f0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>是flag00不是level00了。<br>这里利用的是suid 提权。研究下原理<br>先看flag00的权限<br><img src="https://upload-images.jianshu.io/upload_images/5443560-ddf0bd66d9fab286.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>有setUid<br>setUid的功能是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、SUID权限仅对二进制程序有效。</span><br><span class="line">2、执行者对于该程序需要具有x的可执行权限。</span><br><span class="line">3、本权限仅在执行该程序的过程中有效。</span><br><span class="line">4、执行者将具有该程序拥有者的权限。</span><br></pre></td></tr></table></figure></p>
<p>再用IDA查看下flag00<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">__gid_t</span> v3; <span class="comment">// ST18_4</span></span><br><span class="line">  <span class="keyword">__uid_t</span> v4; <span class="comment">// ST1C_4</span></span><br><span class="line"></span><br><span class="line">  v3 = getegid();</span><br><span class="line">  v4 = geteuid();</span><br><span class="line">  setresgid(v3, v3, v3);</span><br><span class="line">  setresuid(v4, v4, v4);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Congrats, now run getflag to get your flag!"</span>);</span><br><span class="line">  <span class="keyword">return</span> execve(<span class="string">"/bin/sh"</span>, (<span class="keyword">char</span> *<span class="keyword">const</span> *)argv, (<span class="keyword">char</span> *<span class="keyword">const</span> *)envp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>所以大体的原理就是<code>flag00</code>属于<code>flag00</code>这个用户,在<code>level00</code>这个组。<br>在<code>level00</code>这个用户也在<code>level00</code>这个组里面，这里拥有执行权限,而程序又有<code>suid</code>，因此<code>level00</code>在运行这个程序的时候暂时性拥有这个<code>flag00</code>的权限，接下来执行一个<code>shell</code>，并且这个<code>shell</code>传进的环境继承刚刚的环境,因此<code>shell</code>运行的时候的权限还是属于<code>flag00</code>的</p>
<h2 id="0x02-level01"><a href="#0x02-level01" class="headerlink" title="0x02 level01"></a>0x02 level01</h2><blockquote>
<p>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?<br>To do this level, log in as the level01 account with the password level01. Files for this level can be found in /home/flag01.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">gid_t</span> gid;</span><br><span class="line">  <span class="keyword">uid_t</span> uid;</span><br><span class="line">  gid = getegid();</span><br><span class="line">  uid = geteuid();</span><br><span class="line"></span><br><span class="line">  setresgid(gid, gid, gid);</span><br><span class="line">  setresuid(uid, uid, uid);</span><br><span class="line"></span><br><span class="line">  system(<span class="string">"/usr/bin/env echo and now what?"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个文件也有suid,关键在最后一句，我们能不能让最后一句执行shell。<br>这里面<code>/usr/bin/env</code>后面跟着的是环境变量中的可执行程序，正常这一句，应该要在环境变量中寻找echo 这个可执行程序<br><img src="https://upload-images.jianshu.io/upload_images/5443560-51d87655eb032c8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/5443560-bb403037400503a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>这个时候就会执行正常的echo。那我们的思路是</p>
<blockquote>
<p>在/usr/bin这个环境变量之前添加个环境变量<code>/home/level01</code>，在’level01’里面有个我们自定义的echo.</p>
</blockquote>
<p>这样不就执行我们自己的程序了<br><img src="https://upload-images.jianshu.io/upload_images/5443560-75e27c0b066bfa50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x03-level02"><a href="#0x03-level02" class="headerlink" title="0x03 level02"></a>0x03 level02</h2><blockquote>
<p>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?<br>To do this level, log in as the level02 account with the password level02. Files for this level can be found in /home/flag02.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *buffer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">gid_t</span> gid;</span><br><span class="line">  <span class="keyword">uid_t</span> uid;</span><br><span class="line"></span><br><span class="line">  gid = getegid();</span><br><span class="line">  uid = geteuid();</span><br><span class="line"></span><br><span class="line">  setresgid(gid, gid, gid);</span><br><span class="line">  setresuid(uid, uid, uid);</span><br><span class="line"></span><br><span class="line">  buffer = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  asprintf(&amp;buffer, <span class="string">"/bin/echo %s is cool"</span>, getenv(<span class="string">"USER"</span>));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"about to call system(\"%s\")\n"</span>, buffer);</span><br><span class="line">  </span><br><span class="line">  system(buffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>跟上面类似，就要构造USER的值来填补，就可以进一步调用<code>/bin/sh</code><br><img src="https://upload-images.jianshu.io/upload_images/5443560-8ce2a50e7a50a783.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x04-level03"><a href="#0x04-level03" class="headerlink" title="0x04 level03"></a>0x04 level03</h2><blockquote>
<p>Check the home directory of flag03 and take note of the files there.<br>There is a crontab that is called every couple of minutes.<br>To do this level, log in as the level03 account with the password level03. Files for this level can be found in /home/flag03.</p>
</blockquote>
<p>在<code>/home/flag03</code>里面发现有一个文件<code>writable.sh</code>和<code>writable.d</code><br>查看<code>writeable.sh</code>的内容<br><img src="https://upload-images.jianshu.io/upload_images/5443560-a88076a133a16e24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>大意就是循环执行一遍writable.d文件夹底下的文件。然后删除。这个时候看题目，<code>There is a crontab that is called every couple of minutes.</code>几分钟会被调用一次。我们猜测可能是执行<code>writable.sh</code><br>把我们要执行的东西写到 <code>writable.d</code>里面去<br><img src="https://upload-images.jianshu.io/upload_images/5443560-09048910817293bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>然后等个几分钟<br><img src="https://upload-images.jianshu.io/upload_images/5443560-326b1e34111dcb4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>接下来我们用root身份来看下corntab.<br><img src="https://upload-images.jianshu.io/upload_images/5443560-74c7cc753e68f46b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/5443560-382ad96faf251a97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>每三分钟执行一次<code>writable.sh</code></p>
<h2 id="0x05-level04"><a href="#0x05-level04" class="headerlink" title="0x05 level04"></a>0x05 level04</h2><blockquote>
<p>This level requires you to read the token file, but the code restricts the files that can be read. Find a way to bypass it :)<br>To do this level, log in as the level04 account with the password level04. Files for this level can be found in /home/flag04.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">  <span class="keyword">int</span> fd, rc;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(argc == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"%s [file to read]\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">strstr</span>(argv[<span class="number">1</span>], <span class="string">"token"</span>) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"You may not access '%s'\n"</span>, argv[<span class="number">1</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fd = open(argv[<span class="number">1</span>], O_RDONLY);</span><br><span class="line">  <span class="keyword">if</span>(fd == <span class="number">-1</span>) &#123;</span><br><span class="line">      err(EXIT_FAILURE, <span class="string">"Unable to open %s"</span>, argv[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  rc = read(fd, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(rc == <span class="number">-1</span>) &#123;</span><br><span class="line">      err(EXIT_FAILURE, <span class="string">"Unable to read fd %d"</span>, fd);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, buf, rc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析:查看文件<br><img src="https://upload-images.jianshu.io/upload_images/5443560-7ee53af01e3ece0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><code>token</code>这个文件的权限是<code>0600</code>，只允许flag04用户读取,没有读取权限。<br>但是flag04这个文件我们有执行权限，隶属于flag04用户，并且有suid。<br>简单分析源码，这个程序的主要功能就是读取文件输出。所以只要我们利用这个文件来读物token 就行，但是有个限制，就是读取的文件名不能叫做<code>token</code>。所以只需要利用软连接，建立一个名字中不含有<code>token</code>的文件，软链接到token 。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5443560-d30318a0f9bd3f7b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/5443560-356a30698bc1a87e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x06-level05"><a href="#0x06-level05" class="headerlink" title="0x06 level05"></a>0x06 level05</h2><blockquote>
<p>Check the flag05 home directory. You are looking for weak directory permissions<br>To do this level, log in as the level05 account with the password level05. Files for this level can be found in /home/flag05.</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/5443560-8fec3b78daf9ddca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>看到<code>.ssh</code>文件夹，推测可能是想通过ssh 登陆进来，但是<code>.ssh</code>文件夹的权限<code>700</code>。我们没有查看权限。这时候看到backup文件夹<br><img src="https://upload-images.jianshu.io/upload_images/5443560-a53be6bb86afe6bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>看到一个备份文件夹。<br><img src="https://upload-images.jianshu.io/upload_images/5443560-17ad621643eb194c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>解压下，果然是<code>.ssh</code>的压缩，就可以利用私钥登陆<br><img src="https://upload-images.jianshu.io/upload_images/5443560-4c5f2065afbccb0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/5443560-801ef1892f28383a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>登陆成功</p>
<h2 id="0x07-level06"><a href="#0x07-level06" class="headerlink" title="0x07 level06"></a>0x07 level06</h2><blockquote>
<p>The flag06 account credentials came from a legacy unix system.<br>To do this level, log in as the level06 account with the password level06. Files for this level can be found in /home/flag06.</p>
</blockquote>
<p>通过这句话<code>The flag06 account credentials came from a legacy unix system.</code>，比较旧版本的Unix的密码是放在<code>/etc/passwd</code><br><img src="https://upload-images.jianshu.io/upload_images/5443560-a1d5b80a3510410a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>这个时候我们就可以用<code>john</code>爆破，这里用的是<code>kali</code>上自带的<br><img src="https://upload-images.jianshu.io/upload_images/5443560-484f9d9e3d8606ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>然后登陆</p>
<h2 id="0x08-level07"><a href="#0x08-level07" class="headerlink" title="0x08 level07"></a>0x08 level07</h2><blockquote>
<p>The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.<br>To do this level, log in as the level07 account with the password level07. Files for this level can be found in /home/flag07.<br>源码<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> CGI <span class="string">qw&#123;param&#125;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type: text/html\n\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">ping</span> </span>&#123;</span><br><span class="line">  $host = $_[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">print</span>(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;"</span>);</span><br><span class="line"></span><br><span class="line">  @output = <span class="string">`ping -c 3 $host 2&gt;&amp;1`</span>;</span><br><span class="line">  <span class="keyword">foreach</span> $line (@output) &#123; <span class="keyword">print</span> <span class="string">"$line"</span>; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">print</span>(<span class="string">"&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if Host set. if not, display normal page, etc</span></span><br><span class="line"></span><br><span class="line">ping(param(<span class="string">"Host"</span>));</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>看这行代码<code>ping -c 3 $host 2&gt;&amp;1</code>,典型的命令注入，构造<code>host=127.0.01;whoami</code>就可以执行whoami</p>
<h2 id="0x09-level08"><a href="#0x09-level08" class="headerlink" title="0x09 level08"></a>0x09 level08</h2><blockquote>
<p>World readable files strike again. Check what that user was up to, and use it to log into flag08 account.<br>To do this level, log in as the level08 account with the password level08. Files for this level can be found in /home/flag08.</p>
</blockquote>
<p>看到一个流量包<br><img src="https://upload-images.jianshu.io/upload_images/5443560-b2096557d4e9ec72.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>wireshark 追踪流，以16进制形式展开<br><img src="https://upload-images.jianshu.io/upload_images/5443560-fd871199d9ea41db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>其中<code>7f</code>是删除键,所以密码为<code>backd00Rmate</code></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5443560-7aedc30548473071.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x0A-level09"><a href="#0x0A-level09" class="headerlink" title="0x0A level09"></a>0x0A level09</h2><blockquote>
<p>There’s a C setuid wrapper for some vulnerable PHP code…<br>To do this level, log in as the level09 account with the password level09. Files for this level can be found in /home/flag09.</p>
</blockquote>
<p>源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spam</span><span class="params">($email)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  $email = preg_replace(<span class="string">"/\./"</span>, <span class="string">" dot "</span>, $email);</span><br><span class="line">  $email = preg_replace(<span class="string">"/@/"</span>, <span class="string">" AT "</span>, $email);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> $email;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">markup</span><span class="params">($filename, $use_me)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  $contents = file_get_contents($filename);</span><br><span class="line"></span><br><span class="line">  $contents = preg_replace(<span class="string">"/(\[email (.*)\])/e"</span>, <span class="string">"spam(\"\\2\")"</span>, $contents);</span><br><span class="line">  $contents = preg_replace(<span class="string">"/\[/"</span>, <span class="string">"&lt;"</span>, $contents);</span><br><span class="line">  $contents = preg_replace(<span class="string">"/\]/"</span>, <span class="string">"&gt;"</span>, $contents);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> $contents;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$output = markup($argv[<span class="number">1</span>], $argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> $output;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="0x0B-level10"><a href="#0x0B-level10" class="headerlink" title="0x0B level10"></a>0x0B level10</h2><blockquote>
<p>The setuid binary at <strong>/home/flag10/flag10</strong> binary will upload any file given, as long as it meets the requirements of the <a href="http://linux.die.net/man/2/access" target="_blank" rel="noopener">access()</a> system call.</p>
</blockquote>
<p>源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *file;</span><br><span class="line">  <span class="keyword">char</span> *host;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(argc &lt; <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"%s file host\n\tsends file to host if you have access to it\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  file = argv[<span class="number">1</span>];</span><br><span class="line">  host = argv[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(access(argv[<span class="number">1</span>], R_OK) == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> fd;</span><br><span class="line">      <span class="keyword">int</span> ffd;</span><br><span class="line">      <span class="keyword">int</span> rc;</span><br><span class="line">      <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">sin</span>;</span></span><br><span class="line">      <span class="keyword">char</span> buffer[<span class="number">4096</span>];</span><br><span class="line"></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Connecting to %s:18211 .. "</span>, host); fflush(<span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">      fd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">memset</span>(&amp;<span class="built_in">sin</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(struct sockaddr_in));</span><br><span class="line">      <span class="built_in">sin</span>.sin_family = AF_INET;</span><br><span class="line">      <span class="built_in">sin</span>.sin_addr.s_addr = inet_addr(host);</span><br><span class="line">      <span class="built_in">sin</span>.sin_port = htons(<span class="number">18211</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(connect(fd, (<span class="keyword">void</span> *)&amp;<span class="built_in">sin</span>, <span class="keyword">sizeof</span>(struct sockaddr_in)) == <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"Unable to connect to host %s\n"</span>, host);</span><br><span class="line">          <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HITHERE <span class="meta-string">".oO Oo.\n"</span></span></span><br><span class="line">      <span class="keyword">if</span>(write(fd, HITHERE, <span class="built_in">strlen</span>(HITHERE)) == <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"Unable to write banner to host %s\n"</span>, host);</span><br><span class="line">          <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> HITHERE</span></span><br><span class="line"></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Connected!\nSending file .. "</span>); fflush(<span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">      ffd = open(file, O_RDONLY);</span><br><span class="line">      <span class="keyword">if</span>(ffd == <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"Damn. Unable to open file\n"</span>);</span><br><span class="line">          <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      rc = read(ffd, buffer, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">      <span class="keyword">if</span>(rc == <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"Unable to read from file: %s\n"</span>, strerror(errno));</span><br><span class="line">          <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      write(fd, buffer, rc);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"wrote file!\n"</span>);</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"You don't have access to %s\n"</span>, file);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一种叫文件访问竞态条件的漏洞.维基百科里面介绍的很详细了<br><a href="https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use" target="_blank" rel="noopener">Time_of_check_to_time_of_use</a>.<br>大体利用是这用的。先大体看下代码<br>首先通过access 验证是否有文件读取权限<code>if(access(argv[1], R_OK) == 0)</code>。前面有说到<code>suid</code>会在执行的时候暂时性拥有文件拥有者的权限。这个在底层代码里面体现为<code>euid</code>，即<code>有限的uid</code>，比如我当前用户是<code>level10</code>,uid为<code>1011</code>，那执行正常的程序的时候我们<code>euid=uid=1011</code>，但是在有<code>suid</code>的程序中，<code>euid=文件拥有者的uid=flag10的uid=989</code>。一般的判断都是通过euid。<br>但是这里有个意外，就是<code>access</code>是通过<code>uid</code>而不是<code>euid</code>。所以这里，执行者为<code>level10</code>，没有执行的权限，验证不通过。<br>维基百科上给出的利用条件是利用软连接<br>代码是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if(access(文件名, R_OK) == 0) &#123;</span><br><span class="line">        ...</span><br><span class="line">	ffd = open(file, O_RDONLY);</span><br><span class="line">	...</span><br><span class="line">	rc = read(ffd, buffer, sizeof(buffer));	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们用个软连接，让access之前lntoken 链接到 faketoken，这里的话，level10对 faketoken具有读取权限，验证通过。。接下来在open之前。把<br>lntoken 链接到token，这个时候由于是suid，而且open 验证的是euid。所以读取成功。我们想实现的伪代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ln -sf faketoken lntoken</span><br><span class="line">if(access(文件名, R_OK) == 0) &#123; =&gt; 验证通过</span><br><span class="line">      ln -sf realtoken lntoken =&gt; 已经指向正确的token 了</span><br><span class="line">        ...</span><br><span class="line">	ffd = open(file, O_RDONLY);</span><br><span class="line">	...</span><br><span class="line">	rc = read(ffd, buffer, sizeof(buffer));	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种现象在单线程下几乎不可能，控制到那么精准的时间更换软连接。<br>但是现在的Linux几乎是多线程的，就可以条件竞争。<br>具体利用如下<br>新建fakeotkoen<br><img src="https://upload-images.jianshu.io/upload_images/5443560-0f2d1200236ef762.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>新建个不断软连接的死循环，这里我用<code>-x</code> 方便看到具体过程<br><img src="https://upload-images.jianshu.io/upload_images/5443560-1a8cd7ab4c2f8ea4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><img src="https://upload-images.jianshu.io/upload_images/5443560-09cf1de358ac6548.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>再看一个终端，不断执行程序<br><img src="https://upload-images.jianshu.io/upload_images/5443560-a4762cc935be3785.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png">。</p>
<p>接收到真的token<br><img src="https://upload-images.jianshu.io/upload_images/5443560-c4689c881e588181.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>可以登录了</p>
<h2 id="0x0C-level11"><a href="#0x0C-level11" class="headerlink" title="0x0C level11"></a>0x0C level11</h2><blockquote>
<p>The /home/flag11/flag11 binary processes standard input and executes a shell command.<br>There are two ways of completing this level, you may wish to do both :-)</p>
</blockquote>
<h2 id="0x0D-level12"><a href="#0x0D-level12" class="headerlink" title="0x0D level12"></a>0x0D level12</h2><blockquote>
<p>There is a backdoor process listening on port 50001.</p>
</blockquote>
<p>源码<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> socket = <span class="built_in">require</span>(<span class="string">"socket"</span>)</span><br><span class="line"><span class="keyword">local</span> server = <span class="built_in">assert</span>(socket.bind(<span class="string">"127.0.0.1"</span>, <span class="number">50001</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hash</span><span class="params">(password)</span></span></span><br><span class="line">  prog = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">"echo "</span>..password..<span class="string">" | sha1sum"</span>, <span class="string">"r"</span>)</span><br><span class="line">  data = prog:<span class="built_in">read</span>(<span class="string">"*all"</span>)</span><br><span class="line">  prog:<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line">  data = <span class="built_in">string</span>.<span class="built_in">sub</span>(data, <span class="number">1</span>, <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">local</span> client = server:accept()</span><br><span class="line">  client:send(<span class="string">"Password: "</span>)</span><br><span class="line">  client:settimeout(<span class="number">60</span>)</span><br><span class="line">  <span class="keyword">local</span> line, err = client:receive()</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> err <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">print</span>(<span class="string">"trying "</span> .. line) <span class="comment">-- log from where ;\</span></span><br><span class="line">      <span class="keyword">local</span> h = hash(line)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> h ~= <span class="string">"4754a4f4bd5787accd33de887b9250a0691dd198"</span> <span class="keyword">then</span></span><br><span class="line">          client:send(<span class="string">"Better luck next time\n"</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">          client:send(<span class="string">"Congrats, your token is 413**CARRIER LOST**\n"</span>)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  client:<span class="built_in">close</span>()</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>看下这个程序，就是把你输入的密码经过hash后跟<code>4754a4f4bd5787accd33de887b9250a0691dd198</code>比较，如果一样，就<br>输出<code>Congrats, your token is 413**CARRIER LOST**</code>。这里面的hash是自定义的<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hash</span><span class="params">(password)</span></span></span><br><span class="line">  prog = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">"echo "</span>..password..<span class="string">" | sha1sum"</span>, <span class="string">"r"</span>)</span><br><span class="line">  data = prog:<span class="built_in">read</span>(<span class="string">"*all"</span>)</span><br><span class="line">  prog:<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line">  data = <span class="built_in">string</span>.<span class="built_in">sub</span>(data, <span class="number">1</span>, <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>。问题就出再popen里面<code>prog = io.popen(&quot;echo &quot;..password..&quot; | sha1sum&quot;, &quot;r&quot;)</code>。通过调用系统命令来获取<code>hash</code>的。这一步拼接字符串，造成任意命令执行。<br>所以我们构造<code>;id &gt; /tmp/id</code>看看<br><img src="https://upload-images.jianshu.io/upload_images/5443560-bb28c87f585db5a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>是<code>flag12</code>的</p>
<h2 id="0x0E-level13"><a href="#0x0E-level13" class="headerlink" title="0x0E level13"></a>0x0E level13</h2><blockquote>
<p>There is a security check that prevents the program from continuing execution if the user invoking it does not match a specific user id.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">#define FAKEUID 1000</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv, char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int c;</span><br><span class="line">  char token[256];</span><br><span class="line"></span><br><span class="line">  if(getuid() != FAKEUID) &#123;</span><br><span class="line">      printf(&quot;Security failure detected. UID %d started us, we expect %d\n&quot;, getuid(), FAKEUID);</span><br><span class="line">      printf(&quot;The system administrators will be notified of this violation\n&quot;);</span><br><span class="line">      exit(EXIT_FAILURE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // snip, sorry :)</span><br><span class="line"></span><br><span class="line">  printf(&quot;your token is %s\n&quot;, token);</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一道简单的ELF逆向题，我这里提供两种思路<br>第一种动态调试.我用的是IDA.<br>在IDA的<code>dbgsrv</code>文件夹底下将<code>linux_server</code>拷贝到Linux服务器上运行，<br><img src="https://upload-images.jianshu.io/upload_images/5443560-9763e2be88a4e633.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>，然后打开ida 。<code>Debugger</code> -&gt; <code>run</code> -&gt; <code>remote Linux debugger</code><br>然后开始配置<br><img src="https://upload-images.jianshu.io/upload_images/5443560-76e63267a2c50648.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br><code>Application</code>输要调试程序在服务器上的绝对路径。<br><code>Diresctory</code> 输所在的路径<br><code>Host</code> 输服务器的IP<br>跟OD基本一样了，F2在main函数下个断点，然后单步调试<br><img src="https://upload-images.jianshu.io/upload_images/5443560-4f09ec4a8d99b13e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>执行到<code>080484F9</code>处，<br><img src="https://upload-images.jianshu.io/upload_images/5443560-a48742e20d61da5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>这里面的判断正是<code>if(getuid() != FAKEUID)</code>这个判断，通过修改zf标志位改变执行流程。在服务器端输出token 的值用于登陆<br><img src="https://upload-images.jianshu.io/upload_images/5443560-298de17773e2bd71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>第二种方法是通过IDA静态查看代码，手动计算token的值<br>利用F5插件，查看类C代码<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">__uid_t</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+28h] [ebp-110h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+2Ch] [ebp-10Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// [esp+12Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( getuid() != <span class="number">1000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = getuid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Security failure detected. UID %d started us, we expect %d\n"</span>, v3, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"The system administrators will be notified of this violation"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v7, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v7, <span class="string">"8mjomjh8wml;bwnh8jwbbnnwi;&gt;;88?o;9ob"</span>);</span><br><span class="line">  v4 = *(_DWORD *)<span class="string">";9ob"</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; *((_BYTE *)&amp;v7 + i); ++i )</span><br><span class="line">    *((_BYTE *)&amp;v7 + i) ^= <span class="number">0x5A</span>u;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"your token is %s\n"</span>, &amp;v7);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>关键在<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">memset(&amp;v7, 0, 0x100u);</span><br><span class="line">strcpy(&amp;v7, &quot;8mjomjh8wml;bwnh8jwbbnnwi;&gt;;88?o;9ob&quot;);</span><br><span class="line">v4 = *(_DWORD *)&quot;;9ob&quot;;</span><br><span class="line">for ( i = 0; *((_BYTE *)&amp;v7 + i); ++i )</span><br><span class="line">  *((_BYTE *)&amp;v7 + i) ^= 0x5Au;</span><br><span class="line">return printf(&quot;your token is %s\n&quot;, &amp;v7);</span><br></pre></td></tr></table></figure></p>
<p>这里面V7的值就是token 。我使用python 计算<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2018-06-07 19:13:48</span></span><br><span class="line"><span class="comment"># @Author  : daiker (daikersec@gmail.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://daikersec.com</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line">token = <span class="string">"8mjomjh8wml;bwnh8jwbbnnwi;&gt;;88?o;9ob"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join([chr(ord(i)^<span class="number">0x5A</span>) <span class="keyword">for</span> i <span class="keyword">in</span> token])</span><br></pre></td></tr></table></figure></p>
<p>得到token <img src="https://upload-images.jianshu.io/upload_images/5443560-594ecec88edc3427.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x0F-level14"><a href="#0x0F-level14" class="headerlink" title="0x0F level14"></a>0x0F level14</h2><blockquote>
<p>This program resides in /home/flag14/flag14. It encrypts input and writes it to standard output. An encrypted token file is also in that home directory, decrypt it :)</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/5443560-f39225877ed23dc8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>是个加密程序，利用IDA来看下加密算法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">int __cdecl __noreturn main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  bool v3; // cf</span><br><span class="line">  bool v4; // zf</span><br><span class="line">  signed int v5; // ecx</span><br><span class="line">  const char *v6; // esi</span><br><span class="line">  _BYTE *v7; // edi</span><br><span class="line">  int v8; // [esp+2Ch] [ebp-5Ch]</span><br><span class="line">  signed int i; // [esp+30h] [ebp-58h]</span><br><span class="line">  signed int v10; // [esp+34h] [ebp-54h]</span><br><span class="line">  char buf[64]; // [esp+3Ch] [ebp-4Ch]</span><br><span class="line">  unsigned int v12; // [esp+7Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v12 = __readgsdword(0x14u);</span><br><span class="line">  v8 = 0;</span><br><span class="line">  if ( argc &lt;= 1 )</span><br><span class="line">    goto LABEL_17;</span><br><span class="line">  v3 = __CFADD__(argv, 4);</span><br><span class="line">  v4 = argv + 1 == 0;</span><br><span class="line">  v5 = 3;</span><br><span class="line">  v6 = argv[1];</span><br><span class="line">  v7 = &amp;unk_8048660;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    if ( !v5 )</span><br><span class="line">      break;</span><br><span class="line">    v3 = (const unsigned __int8)*v6 &lt; *v7;</span><br><span class="line">    v4 = *v6++ == *v7++;</span><br><span class="line">    --v5;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v4 );</span><br><span class="line">  if ( (!v3 &amp;&amp; !v4) != v3 )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_17:</span><br><span class="line">    printf(&quot;%s\n\t-e\tEncrypt input\n&quot;, *argv);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = read(0, buf, 0x40u);</span><br><span class="line">    if ( v10 &lt;= 0 )</span><br><span class="line">      break;</span><br><span class="line">    for ( i = 0; i &lt; v10; ++i )</span><br><span class="line">      buf[i] += v8++;</span><br><span class="line">    if ( write(1, buf, v10) &lt;= 0 )</span><br><span class="line">      exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  exit(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>核心加密在</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = read(0, buf, 0x40u);</span><br><span class="line">    if ( v10 &lt;= 0 )</span><br><span class="line">      break;</span><br><span class="line">    for ( i = 0; i &lt; v10; ++i )</span><br><span class="line">      buf[i] += v8++;</span><br><span class="line">    if ( write(1, buf, v10) &lt;= 0 )</span><br><span class="line">      exit(0);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>就是将每个字节的ASCII加上0,1,2,3这样，用python 写个解密算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date    : 2018-06-07 19:53:26</span></span><br><span class="line"><span class="comment"># @Author  : daiker (daikersec@gmail.com)</span></span><br><span class="line"><span class="comment"># @Link    : http://daikersec.com</span></span><br><span class="line"><span class="comment"># @Version : $Id$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"token"</span>,<span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">	order = <span class="number">0</span></span><br><span class="line">	token = <span class="string">""</span></span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">		data = f.read(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		token += chr(ord(data)-order)</span><br><span class="line">		order += <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> token</span><br></pre></td></tr></table></figure>
<p>token为<img src="https://upload-images.jianshu.io/upload_images/5443560-5b493df2ecca5a4b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="0x10level15"><a href="#0x10level15" class="headerlink" title="0x10level15"></a>0x10level15</h2><blockquote>
<p><a href="http://linux.die.net/man/1/strace" target="_blank" rel="noopener">strace</a> the binary at <strong>/home/flag15/flag15</strong> and see if you spot anything out of the ordinary.You may wish to <a href="http://www.google.com.au/search?q=compile%20shared%20library%20linux" target="_blank" rel="noopener">review</a> how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the <strong>dlopen</strong> manpage in depth.<br>Clean up after yourself :)</p>
</blockquote>
<h2 id="0x11-level16"><a href="#0x11-level16" class="headerlink" title="0x11 level16"></a>0x11 level16</h2><blockquote>
<p>There is a perl script running on port 1616.</p>
</blockquote>
<p>源码<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> CGI <span class="string">qw&#123;param&#125;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type: text/html\n\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">login</span> </span>&#123;</span><br><span class="line">  $username = $_[<span class="number">0</span>];</span><br><span class="line">  $password = $_[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  $username =~ <span class="regexp">tr/a-z/A-Z/</span>; <span class="comment"># conver to uppercase</span></span><br><span class="line">  $username =~ <span class="regexp">s/\s.*//</span>;        <span class="comment"># strip everything after a space</span></span><br><span class="line"></span><br><span class="line">  @output = <span class="string">`egrep "^$username" /home/flag16/userdb.txt 2&gt;&amp;1`</span>;</span><br><span class="line">  <span class="keyword">foreach</span> $line (@output) &#123;</span><br><span class="line">      ($usr, $pw) = <span class="keyword">split</span>(<span class="regexp">/:/</span>, $line);</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>($pw =~ $password) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">htmlz</span> </span>&#123;</span><br><span class="line">  <span class="keyword">print</span>(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Login resuls&lt;/title&gt;&lt;/head&gt;&lt;body&gt;"</span>);</span><br><span class="line">  <span class="keyword">if</span>($_[<span class="number">0</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">print</span>(<span class="string">"Your login was accepted&lt;br/&gt;"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">print</span>(<span class="string">"Your login failed&lt;br/&gt;"</span>);</span><br><span class="line">  &#125;    </span><br><span class="line">  <span class="keyword">print</span>(<span class="string">"Would you like a cookie?&lt;br/&gt;&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">htmlz(login(param(<span class="string">"username"</span>), param(<span class="string">"password"</span>)));</span><br></pre></td></tr></table></figure></p>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
    
        <a href="/wiki/ba9a968.html" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">铁人三项2018第七赛区(福建)数据赛wp</div>
        </a>
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            daiker &copy; 2018 
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        

    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>